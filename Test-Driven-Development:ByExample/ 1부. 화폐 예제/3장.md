### 3장. 모두를 위한 평등
#### 값 객체 패턴
- 어떤 계약에 새로운 보상 항목을 추가하면 그 계약 자체가 변하게 되는 것이다.
- Dollar 객체 같이 객체를 값처럼 쓸 수 있는데 이것을 **값 객체 패턴**이라고 한다. 
- 값 객체에 대한 제약 사항 중 하나는 객체의 인스턴스 변수가 생성자를 통해서 일단 설정된 후에는 결코 변하지 않는다는 것이다. 
- 값 객체를 사용하면 별칭에 대해 걱정할 필요가 없다. 
- 값 객체가 암시하는 것 중 하나는 **모든 연산은 새 객체를 반환해야 한다**는 것이다.
- 또다른 암시는 값 객체는 **equals()** 를 구현해야한다는 것이다. 
```java
public void testEquality() {
    assertTrue(new Dollar(5).equals(new Dollar(5)));
}

public boolean equals(Object object) {
    return true;
}
-> 단순히 true를 반환해서 초록 막대로 만든다. 
```
- 만약 값 개체를 해시 테이블의 키로 쓸 생각이라면 equals()를 구현할 때 **hashCode()** 를 같이 구현해야한다. 

#### 삼각측량
- 만약 라디오 신호를 두 수신국이 감지하고 있을 때, 수신국 사이의 거리가 알려져 있고 각 수순국이 신호의 방향을 알고 있다면, 이 정보들만으로 충분히 신호의 거리와 방위를 알 수 있다. 
  - 이러한 계산법을 삼각측량이라고 한다. 
- 삼각측량을 이용하려면 예제가 두 개 이상있어야만 코드를 일반화할 수 있다. 
- 두번째 예가 좀 더 일반적인 해를 필요로 할 때, 오로지 그때만 비로소 일반환한다. 

- 두번째 예제를 넣고 동치성을 일반화해야한다. 
```java
public void testEquality() {
    assertTrue(new Dollar(5).equals(new Dollar(5)));
    assertFalse(new Dollar(5).equals(new Dollar(6)));
}

public boolean equals(Object object) {
    Dollar dollar = (Dollar) object;
    return amount == dollar.amount;
}
```
- 어떻게 리팩토링해야하는지전혀 감이 안 올때만 삼각측량을 사용한다. 
- 일반적인 방법이 떠오르면 삼각측량을 사용하지 않아도 되지만 설계를 어떠헤 할지 떠오르지 않을 떄면, 삼각측량은 문제를 조금 다른 방향으로 생각해볼 기회를 제공한다. 

#### 어떤 내용을 했는가
1. 디자인 패턴(값 객체)이 하나의 또 다른 오퍼레이션을 암시한다는 걸 알아챘다. 
2. 해당 오퍼레이션을 테스트했다. 
3. 해당 오퍼레이션을 간단히 구현했다. 
4. 곧장 리팩토링을 하는 대신 테스트를 조금 더 했다. 
5. 두 경우를 모두 수용할 수 있도록 리팩토링했다. 
